---
title: "final"
format: html
editor: visual
---

## Examining the effects of paid family leave policy on unemployment: A case study of California

### Introduction

**Privately funded and unpaid leave vs. state-subsidized leave**\
Paid leave programs without state support often create more problems than they solve. In 2001, Korea introduced a paid maternal leave policy as an incentive for young women to enter full-time professional work. In practice, the firms themselves and private insurance companies bore the cost, so firms who could not afford to compensate their workers often opted out. The concurrent financial crisis in East Asia pressured Korean women into full-time professional work, but mothers without insurance or an employer willing to pay their salary had to finance their own leave (Li, 2014).  The United States operates on a similar voluntary basis, with a federal unpaid leave program and only 16% of private sector employees having access to paid family leave (Donovan, 2019). Workplace protections for women implemented in Taiwan  which included mandated paid maternal leave, preceded reductions in the employment rate and wages of young women, as employers began to view women of child-rearing age as financial liabilities (Lai, Zu-Cheng, & Sarkar, 2016). In Colombia, the introduction of a new law extending the mandatory unpaid maternal leave period from 12 to 14 weeks preceded increases in inactivity rates, informal labor, and self-employment among women of child bearing age (Uribe et al., 2019).  In cases where the firm is solely responsible for compensating the mother and hiring replacement workers, employers often develop discriminatory attitudes towards women during the hiring and promotion process (Espino & Salvador, 2016).

Though the economic outcomes of state-subsidized leave is debatable, the positive health outcomes are well-documented.  In contrast to Korea, where the post-reform period saw decreases in the fertility rate (Li, 2014), a study of families in Iceland, Norway, and Sweden (where the state fully subsidizes leave) found that usage of paternal leave correlated with a greater probability of rearing a second child (Duvander et al., 2019).  Leave expansions in OECD countries saw significant decreases in infant and neonatal mortality rates, as well as fatalities from measles (Khan et al, 2020). Citizens in countries with more generous leave programs even tended to have more favorable attitudes towards women’s rights and economic independence (Givati & Troiano, 2012). A recent NBER cost-benefit analysis simulated the effects of a 4-week and 12-week long paid leave program in the United States, with conservative estimates returning around \$8,000 in societal benefits for every \$1,000 spent (Wang et al, 2024). However, existing data on state-subsidized family leave in Norway saw no significant crowding out of private childcare services (that is, beneficial reductions in private spending as government spending increases), minimal changes in labor market participation and children’s health and wellbeing, and possible upwards transfers of wealth, as middle and upper class families are better equipped to take advantage of time off from work (Dahl, Gordon, 2016).

Generous family leave policy is not an immediate cure for social issues and high employment, but can create positive outcomes for the health and well-being of families. Today, state governments are re-evaluating their positions in relation to family leave policy, mediating between the private and public sectors. For example, the “Big Beautiful Bill” proposes tax credits for private firms that offer employees paid leave (which also indicates bipartisan support for family leave in the U.S.).

**Paid leave policy in California**\
The U.S. lags behind other democratic/industrialized nations in formalized leave policy, with existing programs existing mostly at the state level. The last federal-level family leave program was the 1993 Family Medical Leave Act, which provides 12 weeks of unpaid, job-protected leave for new mothers. As of December, 2025, 13 states have enacted versions of paid leave programs, in most of which the state partially or fully replaces wages (the exception being New York, where leave is covered by employers who purchase private insurance through a state-regulated market). 10 states have a voluntary policy, in which coverage is also provided through a private insurance market (Bipartisan Policy Center, 2025).

In 2002, the state of California implemented a family leave policy which provided 6 weeks of leave with 55% wage replacement for new mothers. While maternal health outcomes did improve and mothers' participation in the labor market increased (that is, women disengaged from the labor market opted in), young women also saw increased rates of unemployment (defined as seeking employment, but unable to find employment). As many as 75,000 young women entered the workforce, but women as a whole experienced longer and more frequent periods of unemployment (Das & Polachek, 2014). If true, this report supports previous findings that as protections for mothers increase, the labor market becomes over saturated and employers begin to view mothers as financial liabilities. The intent of the present study is to replicate the findings observed in Das & Polachek, 2014, in order to better understand the relationship between leave policy and the labor market.

### Importing and organizing the data

Data was imported from the IPUMS CPS website. The sample was comprised of adult women aged 24-44 from California, Florida, Pennsylvania, and Texas, surveyed from January of 1999 through December of 2009. Relevant attributes included employment status, labor force participation, and state. Florida, Pennsylvania, and Texas were included as control populations.

```{r}
#| label: setup
#| message: false
#| warning: false

# Load required packages
library(tidyverse)
library(lubridate)
library(tseries)
library(forecast)
library(boot)
library(car)
library(ggplot2)
library(gridExtra)
```

```{r}
#| label: load-data

# Load IPUMS CPS data
ipums_data <- read.csv("california_women_25_44_filtered.csv")
head(ipums_data)
```

```{r}
#| label: data-preparation

# Create unemployment and employment indicators
df <- ipums_data %>%
  mutate(
    unemployed = ifelse(EMPSTAT == 21 | EMPSTAT == 22, 1, 0),
    in_labor_force = ifelse(LABFORCE == 2, 1, 0),
    employed = ifelse(EMPSTAT == 10 | EMPSTAT == 12, 1, 0),
    state_name = case_when(
      STATEFIP == 6 ~ "California",
      STATEFIP == 48 ~ "Texas",
      STATEFIP == 12 ~ "Florida",
      STATEFIP == 42 ~ "Pennsylvania",
      TRUE ~ "Other"
    ),
    policy_period = ifelse(YEAR >= 2004 & MONTH >= 7, "Post", "Pre"),
    date = as.Date(paste(YEAR, MONTH, "01", sep = "-"))
  )

# Check the data structure
glimpse(df)
```

```{r}
#| label: monthly-unemployment-rates

# Calculate monthly unemployment rate by state using survey weights
monthly_unemp <- df %>%
  filter(in_labor_force == 1) %>%
  group_by(state_name, YEAR, MONTH, date) %>%
  summarise(
    unemp_rate = weighted.mean(unemployed, w = WTFINL, na.rm = TRUE) * 100,
    lfpr = mean(in_labor_force, na.rm = TRUE) * 100,
    emp_rate = weighted.mean(employed, w = WTFINL, na.rm = TRUE) * 100,
    n = n(),
    .groups = "drop"
  )

# Separate California and control states
ca_data <- monthly_unemp %>% 
  filter(state_name == "California") %>%
  mutate(policy = ifelse(date >= as.Date("2004-07-01"), 1, 0))

tx_data <- monthly_unemp %>% filter(state_name == "Texas")
fl_data <- monthly_unemp %>% filter(state_name == "Florida")
pa_data <- monthly_unemp %>% filter(state_name == "Pennsylvania")

head(ca_data)
```

### Descriptive Statistics

```{r}
#| label: descriptive-stats

# Split pre and post policy periods
pre_policy <- ca_data %>% filter(date < as.Date("2004-07-01"))
post_policy <- ca_data %>% filter(date >= as.Date("2004-07-01"))

# Summary statistics
desc_stats <- ca_data %>%
  group_by(policy) %>%
  summarise(
    n_months = n(),
    mean_unemp = mean(unemp_rate),
    sd_unemp = sd(unemp_rate),
    min_unemp = min(unemp_rate),
    max_unemp = max(unemp_rate),
    mean_lfpr = mean(lfpr),
    mean_emp = mean(emp_rate)
  )

print(desc_stats)
```

```{r}
#| label: fig-unemployment-timeline
#| fig-cap: "Unemployment Rate for Young Women in California (1999-2009)"

# Visualize unemployment rate over time
ggplot(ca_data, aes(x = date, y = unemp_rate)) +
  geom_line(color = "blue", size = 1) +
  geom_vline(xintercept = as.Date("2004-07-01"), 
             linetype = "dashed", color = "red", size = 1) +
  annotate("text", x = as.Date("2004-07-01"), y = max(ca_data$unemp_rate),
           label = "CA PFL Implementation", vjust = -0.5, hjust = -0.1) +
  labs(title = "Unemployment Rate for Young Women in California",
       x = "Date", y = "Unemployment Rate (%)") +
  theme_minimal()
```

```{r}
#| label: fig-state-comparison
#| fig-cap: "Unemployment Comparison: California vs Control States"

# Compare California vs control states
ggplot(monthly_unemp, aes(x = date, y = unemp_rate, color = state_name)) +
  geom_line(size = 1) +
  geom_vline(xintercept = as.Date("2004-07-01"), 
             linetype = "dashed", color = "gray40") +
  labs(title = "Unemployment Comparison: California vs Control States",
       x = "Date", y = "Unemployment Rate (%)", color = "State") +
  theme_minimal() +
  theme(legend.position = "bottom")
```

### Assumption Testing

```{r}
#| label: normality-tests

# Test for normality (Shapiro-Wilk test)
shapiro_pre <- shapiro.test(pre_policy$unemp_rate)
shapiro_post <- shapiro.test(post_policy$unemp_rate)

cat("Pre-policy normality test:\n")
print(shapiro_pre)
cat("\nPost-policy normality test:\n")
print(shapiro_post)
```

```{r}
#| label: fig-qq-plots
#| fig-cap: "Q-Q Plots for Normality Assessment"

# Q-Q plots for visual normality check
par(mfrow = c(1, 2))
qqnorm(pre_policy$unemp_rate, main = "Q-Q Plot: Pre-Policy")
qqline(pre_policy$unemp_rate)
qqnorm(post_policy$unemp_rate, main = "Q-Q Plot: Post-Policy")
qqline(post_policy$unemp_rate)
```

```{r}
#| label: variance-test

# Test for equal variances (Levene's test)
levene_result <- leveneTest(unemp_rate ~ as.factor(policy), data = ca_data)
print(levene_result)
```

### Hypothesis Testing

```{r}
#| label: ttest-pre-post

# T-test comparing pre vs post policy unemployment rates
t_result <- t.test(pre_policy$unemp_rate, post_policy$unemp_rate, var.equal = FALSE)
print(t_result)

# Calculate effect size (Cohen's d)
mean_diff <- mean(post_policy$unemp_rate) - mean(pre_policy$unemp_rate)
pooled_sd <- sqrt((sd(pre_policy$unemp_rate)^2 + sd(post_policy$unemp_rate)^2) / 2)
cohens_d <- mean_diff / pooled_sd

cat("\nMean difference:", round(mean_diff, 3), "%\n")
cat("Cohen's d:", round(cohens_d, 3), "\n")
```

```{r}
#| label: diff-in-diff

# Difference-in-Differences analysis (CA vs TX)
ca_pre <- ca_data %>% filter(policy == 0) %>% pull(unemp_rate)
ca_post <- ca_data %>% filter(policy == 1) %>% pull(unemp_rate)
tx_pre <- tx_data %>% filter(date < as.Date("2004-07-01")) %>% pull(unemp_rate)
tx_post <- tx_data %>% filter(date >= as.Date("2004-07-01")) %>% pull(unemp_rate)

ca_diff <- mean(ca_post) - mean(ca_pre)
tx_diff <- mean(tx_post) - mean(tx_pre)
did_estimate <- ca_diff - tx_diff

cat("California change:", round(ca_diff, 3), "%\n")
cat("Texas change:", round(tx_diff, 3), "%\n")
cat("Difference-in-Differences estimate:", round(did_estimate, 3), "%\n")
```

```{r}
#| label: chi-square-test

# Chi-square test: Employment status × Policy period
chi_data <- df %>%
  filter(state_name == "California") %>%
  mutate(
    emp_status = case_when(
      employed == 1 ~ "Employed",
      unemployed == 1 ~ "Unemployed",
      TRUE ~ "Not in LF"
    )
  )

chi_table <- table(chi_data$emp_status, chi_data$policy_period)
print(chi_table)

chi_result <- chisq.test(chi_table)
print(chi_result)
```

```{r}
#| label: anova-test

# ANOVA: Compare unemployment across multiple time periods
ca_data <- ca_data %>%
  mutate(
    period = case_when(
      date < as.Date("2002-01-01") ~ "Period 1 (1999-2001)",
      date >= as.Date("2002-01-01") & date < as.Date("2004-07-01") ~ "Period 2 (2002-Jun 2004)",
      date >= as.Date("2004-07-01") & date < as.Date("2006-07-01") ~ "Period 3 (Jul 2004-2006)",
      date >= as.Date("2006-07-01") ~ "Period 4 (2007-2009)"
    )
  )

anova_result <- aov(unemp_rate ~ period, data = ca_data)
summary(anova_result)

# Post-hoc test (Tukey HSD)
tukey_result <- TukeyHSD(anova_result)
print(tukey_result)
```

```{r}
#| label: kruskal-wallis

# Non-parametric alternative: Kruskal-Wallis test
kruskal_result <- kruskal.test(unemp_rate ~ period, data = ca_data)
print(kruskal_result)
```

### Bootstrap Analysis

```{r}
#| label: bootstrap-setup

# Define function to calculate mean difference
mean_diff_func <- function(data, indices) {
  sampled_data <- data[indices, ]
  pre <- sampled_data %>% filter(policy == 0)
  post <- sampled_data %>% filter(policy == 1)
  return(mean(post$unemp_rate) - mean(pre$unemp_rate))
}

# Perform bootstrap (1000 replications)
set.seed(123)
boot_results <- boot(data = ca_data, 
                     statistic = mean_diff_func, 
                     R = 1000)

print(boot_results)
```

```{r}
#| label: bootstrap-ci

# Get bootstrap confidence intervals
boot_ci_perc <- boot.ci(boot_results, type = "perc")
boot_ci_bca <- boot.ci(boot_results, type = "bca")

print(boot_ci_perc)
print(boot_ci_bca)
```

```{r}
#| label: fig-bootstrap-dist
#| fig-cap: "Bootstrap Distribution of Mean Difference"

# Plot bootstrap distribution
hist(boot_results$t, breaks = 30, 
     main = "Bootstrap Distribution of Mean Difference",
     xlab = "Unemployment Rate Difference (Post - Pre)",
     col = "lightblue", border = "white")
abline(v = boot_results$t0, col = "red", lwd = 2)
legend("topright", legend = "Observed Difference", 
       col = "red", lwd = 2)
```

### Time Series Analysis

```{r}
#| label: ts-decomposition

# Convert to time series object
ca_ts <- ts(ca_data$unemp_rate, 
            start = c(1999, 1), 
            frequency = 12)

# Decompose time series
decomp <- decompose(ca_ts)
plot(decomp)
```

```{r}
#| label: fig-acf-pacf
#| fig-cap: "ACF and PACF Plots"

# ACF and PACF plots
par(mfrow = c(1, 2))
acf(ca_ts, main = "ACF: CA Unemployment Rate")
pacf(ca_ts, main = "PACF: CA Unemployment Rate")
```

```{r}
#| label: stationarity-test

# Test for stationarity (Augmented Dickey-Fuller test)
adf_result <- adf.test(ca_ts)
print(adf_result)

# Test differenced series if needed
ca_ts_diff <- diff(ca_ts)
adf_diff <- adf.test(ca_ts_diff)
cat("\nADF test on differenced series:\n")
print(adf_diff)
```

```{r}
#| label: arima-model

# Fit ARIMA model to pre-policy period
pre_policy_ts <- window(ca_ts, end = c(2004, 6))

# Auto ARIMA model selection
arima_model <- auto.arima(pre_policy_ts, 
                          seasonal = TRUE,
                          stepwise = FALSE,
                          approximation = FALSE)
summary(arima_model)
```

```{r}
#| label: arima-diagnostics

# Check model diagnostics
checkresiduals(arima_model)

# Ljung-Box test for residual autocorrelation
ljung_box <- Box.test(residuals(arima_model), lag = 12, type = "Ljung-Box")
print(ljung_box)
```

```{r}
#| label: fig-arima-forecast
#| fig-cap: "ARIMA Forecast vs Actual Unemployment"

# Forecast post-policy period
forecast_horizon <- length(ca_ts) - length(pre_policy_ts)
arima_forecast <- forecast(arima_model, h = forecast_horizon)

# Plot actual vs forecasted
plot(arima_forecast, main = "ARIMA Forecast vs Actual")
lines(ca_ts, col = "red", lwd = 2)
legend("topleft", legend = c("Forecast", "Actual"), 
       col = c("blue", "red"), lwd = 2)
```

```{r}
#| label: forecast-error

# Calculate forecast error (actual - predicted)
post_policy_ts <- window(ca_ts, start = c(2004, 7))
forecast_error <- post_policy_ts - arima_forecast$mean

cat("Average forecast error (policy effect):", round(mean(forecast_error), 3), "%\n")
cat("Median forecast error:", round(median(forecast_error), 3), "%\n")
```

### Intervention Analysis

```{r}
#| label: arima-intervention

# Create policy dummy variable
policy_dummy <- c(rep(0, length(pre_policy_ts)), 
                  rep(1, length(post_policy_ts)))

# Fit ARIMA model with policy intervention
arima_intervention <- auto.arima(ca_ts, 
                                 xreg = policy_dummy,
                                 seasonal = TRUE)
summary(arima_intervention)

cat("\nPolicy effect coefficient:", 
    round(coef(arima_intervention)["policy_dummy"], 3), "%\n")
```

```{r}
#| label: structural-break

# Test for structural break using Chow test
library(strucchange)
sctest_result <- sctest(ca_ts ~ time(ca_ts), 
                        type = "Chow", 
                        point = length(pre_policy_ts))
print(sctest_result)
```

```{r}
#| label: step-trend-model

# Test for immediate vs gradual effect
step_var <- policy_dummy
trend_var <- c(rep(0, length(pre_policy_ts)), 
               1:length(post_policy_ts))

arima_step_trend <- auto.arima(ca_ts, 
                               xreg = cbind(step_var, trend_var))
summary(arima_step_trend)
```

### Robustness Checks

```{r}
#| label: robustness-shorter-window

# Robustness: Exclude 2007-2009 to avoid pre-recession effects
ca_data_short <- ca_data %>% filter(YEAR <= 2006)

pre_short <- ca_data_short %>% filter(policy == 0)
post_short <- ca_data_short %>% filter(policy == 1)

t_robust <- t.test(pre_short$unemp_rate, post_short$unemp_rate, var.equal = FALSE)
cat("Robustness check (excluding 2007-2009):\n")
print(t_robust)
```

```{r}
#| label: placebo-test

# Placebo test: "Fake" policy date at July 2002
ca_data_placebo <- ca_data %>%
  filter(YEAR <= 2003) %>%
  mutate(fake_policy = ifelse(date >= as.Date("2002-07-01"), 1, 0))

placebo_test <- t.test(unemp_rate ~ fake_policy, data = ca_data_placebo)
cat("Placebo test (fake policy in July 2002):\n")
print(placebo_test)
```